!function(e){function t(e,t){return e.toFixed(t.decimals)}var o=function(t,i){this.$element=e(t),this.options=e.extend({},o.DEFAULTS,this.dataOptions(),i),this.init()};o.DEFAULTS={from:0,to:0,speed:1e3,refreshInterval:100,decimals:0,formatter:t,onUpdate:null,onComplete:null},o.prototype.init=function(){this.value=this.options.from,this.loops=Math.ceil(this.options.speed/this.options.refreshInterval),this.loopCount=0,this.increment=(this.options.to-this.options.from)/this.loops},o.prototype.dataOptions=function(){var e={from:this.$element.data("from"),to:this.$element.data("to"),speed:this.$element.data("speed"),refreshInterval:this.$element.data("refresh-interval"),decimals:this.$element.data("decimals")},t=Object.keys(e);for(var o in t){var i=t[o];"undefined"==typeof e[i]&&delete e[i]}return e},o.prototype.update=function(){this.value+=this.increment,this.loopCount++,this.render(),"function"==typeof this.options.onUpdate&&this.options.onUpdate.call(this.$element,this.value),this.loopCount>=this.loops&&(clearInterval(this.interval),this.value=this.options.to,"function"==typeof this.options.onComplete&&this.options.onComplete.call(this.$element,this.value))},o.prototype.render=function(){var e=this.options.formatter.call(this.$element,this.value,this.options);this.$element.text(e)},o.prototype.restart=function(){this.stop(),this.init(),this.start()},o.prototype.start=function(){this.stop(),this.render(),this.interval=setInterval(this.update.bind(this),this.options.refreshInterval)},o.prototype.stop=function(){this.interval&&clearInterval(this.interval)},o.prototype.toggle=function(){this.interval?this.stop():this.start()},e.fn.countTo=function(t){return this.each(function(){var i=e(this),a=i.data("countTo"),n=!a||"object"==typeof t,s="object"==typeof t?t:{},r="string"==typeof t?t:"start";n&&(a&&a.stop(),i.data("countTo",a=new o(this,s))),a[r].call(a)})}}(jQuery);
